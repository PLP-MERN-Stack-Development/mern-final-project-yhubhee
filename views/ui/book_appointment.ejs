<!DOCTYPE html>
<html lang="en">
<%- include('../partials/head') %>
  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>

  <style>
    .about-doctor-scroll {
      max-height: 200px;
      overflow-y: auto;
    }
  </style>

  <body>
    <%- include('../partials/header') %>

      <div class="alert-container">
        <% if (typeof error !=='undefined' ) { %>
          <div class="alert alert-danger alert-dismissible fade show" role="alert">
            <%= error %>
              <button type="button" btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
          <% } %>
            <% if (typeof success !=='undefined' ) { %>
              <div class="alert alert-success alert-dismissible fade show" role="alert">
                <%= success %>
                  <button type="button" btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
              </div>
              <% } %>
      </div>

      <% if (typeof redirect !=='undefined' && redirect) { %>
        <script>
          setTimeout(() => {
            window.location.href = '/patients/dashboard';
          }, 1000);
        </script>
        <% } %>

          <!-- Book Appointment Section Start -->
          <div class="container py-5" data-aos="fade-in">
            <div class="text-center mx-auto mb-5" style="max-width: 600px;">
              <h5 class="d-inline-block text-primary text-uppercase border-bottom border-5" data-aos="fade-up"
                data-aos-delay="100">Book Appointment</h5>
              <h1 class="display-4 mb-4" data-aos="fade-up" data-aos-delay="200">Schedule with <%= doctor %>
              </h1>
              <p class="text-muted" data-aos="fade-up" data-aos-delay="300">Choose your preferred date and time for your
                appointment.</p>
            </div>

            <div class="row justify-content-center">
              <div class="col-lg-6">
                <div class="bg-light rounded p-4 shadow-sm" data-aos="fade-up" data-aos-delay="400">
                  <form action="/auth/submit_appointment" method="POST">
                    <input type="hidden" name="doctor" value="<%= doctor %>">
                    <input type="hidden" name="specialty" value="<%= specialty %>">

                    <div class="mb-4">
                      <label for="appointmentDate" class="form-label fw-bold text-dark">Select Date</label>
                      <input type="date" class="form-control border-primary p-3" id="appointmentDate"
                        name="appointmentDate" required>
                    </div>
                    <div class="mb-4">
                      <label for="appointmentTime" class="form-label fw-bold text-dark">Select Time</label>
                      <input type="time" class="form-control border-primary p-3" id="appointmentTime"
                        name="appointmentTime" required>
                    </div>
                    <div class="text-center">
                      <button type="submit" class="btn btn-primary py-2 px-5 rounded-pill">Confirm Appointment</button>
                    </div>
                  </form>
                </div>
              </div>
            </div>

            <!-- Related Doctors Section -->
            <div class="container-fluid py-5">
              <div class="container">
                <div class="text-center mx-auto mb-5" style="max-width: 800px;">
                  <h5 class="d-inline-block text-primary text-uppercase border-bottom border-5">Related Doctors</h5>
                  <h1 class="display-8">Other trusted <%= specialty %>
                  </h1>
                </div>

                <% if (typeof relatedDoctors !=='undefined' && relatedDoctors.length> 0) { %>
                  <% relatedDoctors.forEach((doc)=> { %>
                    <div class="team-item mx-auto mb-4" style="max-width: 600px;">
                      <div class="row g-0 bg-light rounded overflow-hidden">
                        <div class="col-12 col-sm-5 h-100">
                          <img class="img-fluid h-100" src="/Uploads/<%= doc.doc_img %>" alt="<%= doc.doc_name %>"
                            style="object-fit: cover;">
                        </div>
                        <div class="col-12 col-sm-7 h-100 d-flex flex-column">
                          <div class="mt-auto p-4" style="max-height: 900px; overflow-y: auto;">
                            <h3>
                              <%= doc.doc_name %>
                            </h3>
                            <h6 class="fw-normal fst-italic text-primary mb-4 available-status">
                              <%= doc.specialty %>
                            </h6>
                            <p class="m-0 about-doctor" style="word-wrap: break-word;">
                              <%= doc.about_doctor %>
                            </p>
                          </div>
                          <div class="d-flex justify-content-center mt-2 mt-sm-auto">
                            <a
                              href="/ui/book_appointment?doctor=<%= encodeURIComponent(doc.doc_name) %>&specialty=<%= encodeURIComponent(doc.specialty) %>">
                              <button class="btn btn-primary py-2 px-5">Book Doctor</button>
                            </a>
                          </div>

                        </div>
                      </div>
                    </div>
                    <% }); %>
                      <% } else { %>
                        <p class="text-center text-muted">No related doctors available at this time.</p>
                        <% } %>
              </div>
            </div>
          </div>
          <!-- Book Appointment Section End -->

          <%- include('../partials/footer') %>
  </body>

</html>